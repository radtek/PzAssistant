bug编号约定 A-BBBBS
A：表示bug的严重级别（1：严重性问题，2：偶发，较严重的问题，3：一般性问题）
B：表示bug序号（由4为数字构成）
S：表示bug状态，可用的状态标记如下：
+：未修复，-：已修复，?：还需进一步确认，或具有偶发性，!：临时替代解决，&部分解决

一、严重性问题
【1-0001?】
凭证编辑窗口，在执行插入分录后，已有的分录内容会发生变化（具体变化的有二级科目归到默认子目，借贷金额清零），
这个问题很严重？

【1-0002】

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
二、偶发，较严重的问题
[2-0001-]
发现过程：
    利用一个没有输入金额的分录作为汇兑损益的分录（这个分录曾经使用撤销操作恢复的，且上下移动过），
在输入借贷差额后，借贷还是不平。重启应用后凭证平了后来使用了一个新建的未输入金额的分录重新
测试，故障未重现。这个bug是跟撤销操作或上下移动有关？
    经调试分析，发现由于在移除分录时，没有正确地断开与宿主凭证对象的值改变信号连接（函数签名漏掉
    一个参数），导致在恢复该分录对象后，又再次建立了值改变信号连接，此时如果改变该分录的值，将会
    触发两次宿主凭证对象的adjustSumForValueChanged()方法，同一个差值被合计了两次从而造成借贷
    合计值失准。

[2-0002-]
bug描述：
    在应收启用了外币的账户中进行本期统计时，如果本期没有发生外币原币余额的变动，而只是进行了外币
    的结转汇兑损益，则本期统计的余额计算结果有误（与明细账的余额不一致，明细账余额是正确的）
原因：在进行本期统计确定本期发生的“借方-贷方”的结果方向时，只考虑了原币的发生额，当原币本期无发生
     额时，其差值方向确定为平，但实际上由于执行了汇兑损益的结转，实际是有贷方，所以遇到这种情况
     应该还要考虑外币本币的本期发生额，以确定正确的方向。
     但同样的情况在应付上没有发生错误，这其实是一个偶然，因为在计算余额时，对于应付美金，期初余额
     是借方（值为正），本期发生是贷方（值为负），两者相加实为绝对值的相减，刚好符合计算公式。而
     对于应收，美金期初余额是贷方（值为负），本期发生是贷方值为负），两者相加，就变成了绝对值的
     相加，结果当然出错。

2、在科目配置窗口，在去除科目使用外币的属性时，要检测该科目的外币是否被使用了主要包括3个方面
（1）、在科目所属的科目系统的所有帐套内查找凭证内的分录是否包含使用了该科目且其币种为外币的分录存在。
（2）、在余额表中查找是否在指定的时间区间内存在该科目的外币余额项；
（3）、在当前打开凭证集内是否存在如上第一条所指的情形下的分录存在（因为有些凭证处于修改当中未及时保存，
所有在数据库中是查不到的）


xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
三、一般性问题
【3-0001-】
0001、如果分录的金额不为0，此时改变分录的子目，虽然界面上分录的金额未改变，
但实质上底层的分录对象的金额好像已经改变或清零了（因为此时自动计算的合计值与当前界面显示的不符），
如果此时移动凭证到其他凭证后再回到原先的凭证，就可以看出来被改变子目的分录的金额被清零了。所以
感觉这个bug有些莫名其妙。原因是在分录的子目改变后，如果结果子目不是银行子目，它没有提取分录对象
中原先的数据内容（币种和币值），造成分录的金额被清零。但没有更新界面（因为只有银行子目的改变，才会
引起后续币种和币值的同步改变，也会同步更新界面）。

【3-0002!】
凭证打印缺角问题-左下角的单元格边框没有打印出来。目前只是使用了直接绘制选段的方法填补缺失的线段。

【3-0003-】
在关闭一个账户后，重新打开一个账户，会出现账户配置界面无法显示科目（包括科目系统名及其一二级科目）
原因：在Account类的析构函数中，删除了由AppConfig对象创建的科目系统名称对象（SubSysNameItem）
但AppConfig对象未知晓，仍然保留着失效的结构指针，导致后续打开账户时，要初始化账户支持的科目系统，
而此操作首先要从AppConfig对象获取应用支持的科目系统，而它把已失效的结构指针传递给Account，后续
的甄别操作将此失效对象作为账户不支持的科目系统对待，并未发现已失效。结果好像账户不支持任何的科目系
统从而导致空白。所有说，由宿主对象内创建的对象，并在宿主对象内保存了这些对象的指针，这些对象必须由
宿主对象删除，不能由外部删除。

【3-0004+】
    对期末处理菜单项的启用性控制还不完善（当我把结转汇兑损益的凭证都入账后，却未能启用结转损益操作-
而是全部变灰）

【3-0005-】
    凭证编辑窗口，在输入二级科目时，如果选择了一个被禁用的子目，则要自动启用此子目。但禁用前要提示
用户，以免在用户错误选择的情况下，启用了不该启用的子目。目前遗留的问题是启用后可以保存子目的启用状态，
但如果撤销后，却无法保存启用状态。

【3-0006-】
    在帐套配置页中，当新增帐套后，在帐套切换面板上没有出现新建的帐套

【3-0007-】
    帐套切换面板，当当前帐套的前一帐套未关账的情况下，仍然可以编辑凭证集

【3-0008】
    账户转移记录中的转移状态虽然是已转入目的站点，但预期目的站不是本站，
    不能将其作为已转入本站处理，而是作为转入其他站

【3-0009-】
    在凭证编辑窗口，将分录删除保存后，界面上已没有删除的分录，但在明细账视图中还可以查到，且在应用重新启动
    后被删除的分录又重现了？（我是在删除多个分录后，发现有些分录确实是删除了，但总是遗留有实际未被删除的）
    原因是：DbUtil::_saveBusiactionsInPz(PingZheng *pz)方法的最后一段在迭代删除分录队列时，for循环
    内的i的增长与队列长度的减少同步进行，导致当删除多个分录时，处于队列后面的几个分录无法访问到时就退出了循环

【3-0010+】
    先前已经保存了应收应付发票的统计情况，再次增加应付发票后，统计窗口的保存按钮却始终不可用，
    而按钮的启用情况取决于帐套状态和发票统计情况是否改变。
1、
2、
3、在粘贴两条分录后，列表自动滚动到底部了（即把最后两行滚动到列表的可见范围的底部），这是在已经出现
垂直滚动条的情况下出现的。这导致用户很不适应。
4、
5、
6、
7、如果改变了本站配置，则相应地要修改站点内缓存账户的转移信息（账户文件内的目的站）
8、在保存了凭证集后，未能及时启用结转损益菜单项。
9、在对当前凭证的分录进行金额合计时，曾经发生忽视外币的情况（这是在刚录入分录后出现的情况），
在重新打开凭证集后，还是存在。在重新启动应用后，正常？
在当分录中存在缺失未填的一二级科目时，好像汇总计算也有问题？
10、Accountpropertyconfig.cpp，ApcData::viewRates()方法实现，如果要支持多外币，则这里必须支持多币种汇率的输入

11、在创建新名称条目和新二级科目后，要更新科目管理器对象内的相应缓存表，否者，这些新创建的对象无法
从科目管理器对象直接获取。但要实时更新的话，要必须先保存这些对象后获取id，才能够得到缓存表的一个键入口。
这个需求好像是合理的，因为如果我打开了在输入凭证的过程中的实时统计，按照目前的实现必须要通过科目的id来
获取相应的科目对象。添加、移除分录或修改分录的科目、值、方向等都会引起重新统计行为。如果此时有一个分录
内包含的科目是新的。则无法归类该科目对应的统计值

12、在凭证集内的最后一张凭证被删除后，没有禁用删除凭证按钮（不知还是否存在）

13、当新账户没有设置外币时，可能有多个地方会引起崩溃，或弹出没有设置汇率的提醒，但没有使用外币也是一个
合理的情形。这种不合理的提醒和崩溃，要进一步发现。在凭证编辑窗口、本期统计等也会引起崩溃。合理的实现是
不会引起崩溃和提醒，且不出现汇率相关的显示部件。

14、余额显示窗口为什么没有实时更新余额（经查，凭证集对象的save方法没有调用StatUtil::save()方法），
是否有必要根据凭证的编辑结果在按下保存按钮时，连带本期的余额也一并保存呢？或在余额显示窗口中，是显示
保存在数据库中的余额还是实时显示本期凭证集的实时余额呢？

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
四、基本库中存在的问题
1、检查重复的名称条目（已重复的有教育费附加（42）和水利基金（54））我的linux下的版本已被移除


xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
五、样式表问题
1、粉色样式时，行编辑框的选中文本的背景色太浅，导致文本难以辨认
2、表格、列表等的选中行或项的颜色没有适配当前选择样式，只有凭证编辑框正确。
3、主窗口工具条背景色没有应用样式
4、改变样式后，有些子窗口的部件不能实时调整样式（已发现的有本期统计、明细账、科目余额等）
5、在科目配置窗口，某些处于正常状态的按钮的颜色怎么和禁用状态一样？
6、

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
六、功能改进或提升建议
1、登录对话框在main中启动，按取消（要改为退出）则退出应用而不是打开未登录状态下的应用

2、在按下工具条的打印按钮后，自选凭证输入窗口必须只能输入数字，逗号，连字符等，且打印的
凭证范围不能超出当前凭证集的范围。

3、拟将业务客户分为普通业务客户和物流企业两类，普通业务客户是本身没有物流能力的客户，物流
企业是即有物流能力，也可能需要其他物流企业来完成它的物流功能的企业。将物流企业分离出来，
可以作为创建新账户时将这些名称导入。而普通业务客户可以在创建新名称条目时作为补充资源。
这些客户资源可以导出到本地库中分开保存。并在账户配置-科目配置-名称条目配置页中添加导出或
导入这两类客户名称的功能。

4、在打印明细账时，如果要生成大量的页面，可能会阻塞UI界面的响应，最好能显示一个进度条

5、按约定，帐套内只允许最后一个凭证集未结账，这样的话，新建凭证集只有在前一个帐套已结账的情况下才可以。
这样显示余额就可以这样实现，如果该凭证集未结账，则从凭证集的统计对象内获取，否则直接从余额表中读取。
这样又会牵扯到另一个问题，如果最后的凭证集未打开，是否要手工读取该凭证集，并创建统计对象来完成余额
统计？当然，这个策略的优点是可以实时显示余额。

本期统计窗口，是否可以将保存按钮改为确定，如果按确定，则保存当前的统计余额，否则不保存余额直接关闭。

创建结转汇兑损益的凭证或结转损益的凭证，如果它需要的有关科目的余额从统计对象内获取，则可以在未保存余额的
情况下直接创建。但有一个前提，即如果已经创建了结转凭证，则不允许再次修改先前的凭证（即与结转有关的科目的分录，
因为这将导致结转前期余额的改变），也就是说要约定，在执行结转操作前，凭证集内的凭证必须全部入账，且必须注意：
如果它要取消结转前期凭证的审核，则要提醒用户如果修改了相关凭证的相关分录，则必须重新进行结转操作。当然，这些
保护措施要么由应用，要么由用户来实施。

---------------------------------------------------------------------------------------
历史记录：
15、

14、在登出或切换用户后，界面没有调整到适合当前用户的情况。（比如账户配置、帐套面板按钮仍然可用）

13、在打印多个科目的明细账时，如果这些科目要使用不同的表格格式来打印，则在提供分页数据时，视图窗口中显示的数据必须进行转换，将与科目适应的表格数据提供给打印预览对象

12、明细账的条件过滤器要考虑不同科目系统的变化（即过滤条件的保存中还有保存所属的科目系统，或通过保存帐套的信息来达到区分科目系统的目的）

11、在凭证未保存的情况下，关闭程序，没有提示用户有未保存的凭证。

10、在打开凭证编辑窗口后，如果我未对分录做出对应的修改，但好像也要保存分录的所属凭证、分录序号等字段

9、在切换帐套视图后，没有调整凭证号定位输入控件的上下界

8、在升级账户的一级科目表时，没有正确设置科目系统1的借贷方向属性

7、打开凭证集后，在还没有打开凭证编辑视图时，输入要定位的凭证号，但单击定位按钮后，没有打开凭证编辑窗口

6、在将凭证集内的凭证都删除后，没有清空会计分录列表，且没有禁用删除按钮导致再次按删除凭证按钮后崩溃，且此时关闭凭证编辑窗口也会导致程序崩溃


5、在应用打开时，用户选择取消登录（没有禁用帐套切换菜单），在用户登录后，没有启用打开账户的菜单等。

4、帐套启用后，在帐套切换面板上没有立即更新显示，目前的权益之计是重新关闭并打开账户，或重启应用

3、表格空间的视觉效果有待提高（目前用不同的背景色表示各个行所代表行分类：合计行、主科目行、子科目行），
但导致网格线没有显示出来，而且表格的选择行为明明是行选择，但当选择一行时，却没有加亮显示该行。

2、明细账窗口，在显示银行存款科目的明细账时，如果选择了某个具体的子银行科目，则自动选定对应的货币，
   在视图中反映（选择正确的货币类型，并禁用选择货币的选择框），如果选择所有子科目，则自动启用并选择
   所有货币类型

1、记录最后登出的用户，以便下次应用启动时自动选择该用户登录；ok


